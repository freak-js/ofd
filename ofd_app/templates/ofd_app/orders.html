<!doctype html>
<html lang="ru">
<head>
    {% load static %}
    {% load crispy_forms_tags %}
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" type="text/css" href="{% static "bootstrap.css" %}">
    <link rel="stylesheet" type="text/css" href="{% static "stylesheet.css" %}">
    <link rel="icon" type="image/x-icon" href="{% static "favicon.ico" %}">
    <title>Заказы</title>
</head>
<body class="text-center">
    {% include "ofd_app/menu.html" %}
    <div class="container">
        <form action="/orders/" method="POST" id="status" name="status">
        {% csrf_token %}
        <div class="row global_order_nav_div">
            <div class="col-sm-1">
                <span>Заказ №</span>
            </div>
            <div class="col-sm-3">
                <span>Дата</span>
            </div>
            <div class="col-sm-1">
                <span>Количество</span>
            </div>
            <div class="col-sm-2">
                <span>Итог</span>
            </div>
            <div class="col-sm-2">
                <span>Комментарий</span>
            </div>
            <div class="col-sm-1">
                <span>Чекбокс</span>
            </div>
            <div class="col-sm-1">
                <span>Статус</span>
            </div>
            <div class="col-sm-1">
                <span>Кнопка</span>
            </div>
        </div>
        {% for order in orders %}
        <div class="row global_order_nav_div">
            <div class="col-sm-1">
                <span>{{ order.order_num }}</span>
            </div>
            <div class="col-sm-3">
                <span>{{ order.adddate }}</span>
            </div>
            <div class="col-sm-1">
                <span>{{ order.cnt_products }}</span>
            </div>
            <div class="col-sm-2">
                <span>{{ order.total }}</span>
            </div>
            <div class="col-sm-2">
                {% if order.comment %}
                <button type="button" class="btn comment_show_button" data-container="body" data-toggle="popover" data-placement="top" data-content="{{order.comment}}"><i class="fa fa-comment"></i>
                </i></button>
                {% else %}
                <span>Отсутствует</span>
                {% endif %}
            </div>
            <div class="col-sm-1">
                <input type="checkbox" class="form-check-input" name="order_to_status" value="order_ids{{order.id}}" form="top_form">
            </div>
            <div class="col-sm-1">
                <i class="fa fa-circle-notch fa-spin" title="Администратор обрабатывает ваш заказ"></i>
            </div>
            <div class="col-sm-1">
                <button class="btn card_btn" type="button" data-toggle="collapse" data-target="#collapseExample{{order.id}}" aria-expanded="false" aria-controls="collapseExample{{order.id}}"><i class="fa fa-chevron-down"></i></button>
            </div>
            <div class="collapse card_div" id="collapseExample{{order.id}}">
                <div class="card card-body">
                    {% for product in order.products %}
                    <div class="row">
                        <div class="col-sm-2">
                            <span>{{ product.product_name }}</span>
                        </div>
                        <div class="col-sm-3">
                            <span>{{ product.amount }}</span>
                        </div>
                        <div class="col-sm-1">
                            <span>{{ product.cost }}</span>
                        </div>
                        <div class="col-sm-2">
                            <span>{{ product.full_cost }}</span>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
        {% endfor %}
        </form>
    </div>
    

        <!--
        <table class="table table-striped table-sm">
            <thead>
                <tr>
                    <th scope="col"></th>
                    <th scope="col">№</th>
                    <th scope="col">Дата заказа</th>
                    <th scope="col">Количество продуктов</th>
                    <th scope="col">Итог</th>
                    <th scope="col"></th>
                </tr>
            </thead>
            <tbody>
                {% for order in orders %}
                <tr>
                    <td>
                        <a href="/order/{{order.id}}" class="fontawesome_link"><i class="fas fa-eye"></i></a>
                    </td>
                    <td>{{ order.order_num }}</td>
                    <td>{{ order.adddate }}</td>
                    <td>{{ order.cnt_products }}</td>
                    <td>{{ order.total }}</td>
                    <td>
                        {% if perms.ofd_app.manage_order_status %}
                        <input type="checkbox" class="form-check-input" name="order_ids" value="{{order.id}}" form="top_form">
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        -->
    </div>
    <div>
        <button type="submit" class="btn btn-lg btn-primary btn_registration_form" value="A" form="status" name="123">Подтвердить</button>
        <button type="submit" class="btn btn-lg btn-primary btn_registration_form" value="R" form="status">Отклонить</button>
    </div>
    {% include "ofd_app/footer.html" %}
</body>
</html>
